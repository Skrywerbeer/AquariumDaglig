#include "adc.h"

ADC::ADC() {
	ADC0.CTRLB = ADC_SAMPNUM_ACC1_gc;
	ADC0.CTRLC = ADC_REFSEL_VDDREF_gc | ADC_PRESC_DIV16_gc;
	ADC0.MUXPOS = ADC_MUXPOS_AIN3_gc;
	ADC0.CTRLA = ADC_ENABLE_bm;
}

uint16_t ADC::newSample() {
	ADC0.COMMAND = ADC_STCONV_bm;
	while (!ADC0.INTFLAGS & ADC_RESRDY_bm);
	adc.lastValue = ADC0.RES;
	return adc.lastValue;
}
